function handle_country_change(e){var r={country:{url:"/universalui/registration/update_region",container_id:"#region-group"},companyCountry:{url:"/universalui/registration/update_company_region",container_id:"#companyRegion-group"}};$.ajax({type:"POST",url:r[e.target.id].url,data:{selected_country:selectCountry.val(),selected_company_country:selectCompanyCountry.val(),display_region:$(r[e.target.id].container_id).length>0}}).done(function(e){!!e.region&&$(".js-registration-region").html(e.region),!!e.company_region&&$(".js-registration-company-region").html(e.company_region),$("#contactPrefSection").toggleClass("is-hidden fd-has-display-none",!e.show_contact_pref.section),$("#contactPrefEmail-group").toggleClass("is-hidden fd-has-display-none",!e.show_contact_pref.email),$("#contactPrefPhone-group").toggleClass("is-hidden fd-has-display-none",!e.show_contact_pref.phone),!!$.ids&&$.ids.overlay.adjustHeight()})}function set_up_user_name(){$("#userName.js-remove-error-on-keyup").keyup(function(){""==$("#userName").val()||$("#userName").val().match("^(?!.*(i|d|s|c|p)([0-9]){5,9})[a-z0-9]+[a-z0-9._-]*$")?remove_error($("#userName")):($(".js-registration-user-name").addClass("has-error"),$("#userName\\.errors").text("Please do not use a user ID in the user name field. The user name must start with lower case characters a-z or numbers 0-9, and can also contain the following symbols: .-_"))})}function set_up_email(){$("#mail.js-remove-error-on-keyup").keyup(function(e){remove_error($(e.target))})}function _removeError(e,r){var n=e.parents("."+r).first();n&&(n.removeClass(r),resize_overlay())}function remove_error(e){_removeError(e,"fn-input--negative"),_removeError(e,"has-error")}function resize_overlay(){$.ids&&$.ids.overlay.adjustHeight()}function addPadding(e){var r=$("#"+e)[0];if(r)for(var n=0;n<100&&!(r.scrollHeight>r.offsetHeight);n++)$("#"+e).append("<br>")}function makeFieldRequired(e){var r=$("#"+e+"-label");r.parent().find(".ids-required-marker").length||0===$("#"+e+"-required").length&&($("<abbr>",{id:e+"-required","class":"ids-required-marker","aria-hidden":"true"}).text("*").appendTo(r.parent()),r.addClass("fn-label--required"))}function makeFieldOptional(e){$("#"+e+"-required").length&&($("#"+e+"-required").remove(),$("#"+e+"-label").removeClass("fn-label--required"))}var selectCountry,selectCompanyCountry;$(document).ready(function(){selectCountry=$("#country"),selectCompanyCountry=$("#companyCountry"),ZipCountry.initialize("zip","country"),ZipCountry.initialize("companyZip","companyCountry"),set_up_user_name(),set_up_email(),addPadding("touAcceptText"),setPasswordRepeatValidator($("#retypeNewPasswordInput")),selectCountry.change(handle_country_change),selectCompanyCountry.change(handle_country_change),$(".js-remove-error-on-keyup").keyup(function(e){remove_error($(e.target))}),$(".js-remove-error-on-change").change(function(e){remove_error($(e.target))}),$('input:radio[name="contactPrefPhone"]').change(function(){$(this).is(":checked")&&"yes"===$(this).val()?makeFieldRequired("formatted_telephone"):$(this).is(":checked")&&"no"===$(this).val()&&makeFieldOptional("formatted_telephone")}),$("#forgotPasswordLink").attr("href",function(e,r){return r+(-1!==r.indexOf("?")?"&":"?")+"sourceUrl="+encodeURIComponent($.ids.overlay.getParentURI())})});var ZipCountry=function(){"use strict";function e(e,r,n){!n&&document.getElementById(r)&&(e.value?makeFieldRequired(r):makeFieldOptional(r))}function r(r,n,t){$("#"+r).on("keyup",function(){e(this,n,t)}),$("#"+r).on("paste",function(){var r=this;setTimeout(function(){e(r,n,t)},0)})}return{initialize:function(n,t){var o=!1,a=document.getElementById(n);a&&(o=!!$("#"+t+"-required").length,e(a,t,o),r(n,t,o))}}}();